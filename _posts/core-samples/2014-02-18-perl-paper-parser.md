---
layout: post
category : perl
tags : [perl]
title: Paper Parser
tagline: paper parser
---
{% include JB/setup %}
### Paper Parser demo ver 0.1
At first , there has 353 pdf-format papers. I want to know which word is the 'most frequency word'.
Those 353 papers name are in windows format , that means there has 'space' in the filename.
{% highlight sh linenos %}
#!/bin/bash
echo "batch rename. 20140211. ver0.1"
# batch remove the space between filename.
# input : file generated by 'find . -name "*.pdf" > pdf.dir'
find . -name "*.pdf" > windows_name_pdf.dir

i=0
while read line  
do
        filename="${line}";
        i=`echo "$i+1"|bc`
        echo "$i, ${filename}"  
        rename "s/ /_/g" "${filename}"
        #pdftotext "${filename}"  
        #mv "${filename%%.pdf}.txt"  "${filename%%.pdf}.pdftxt" #a new filename extension.
done < windows_name_pdf.dir
rm windows_name_pdf.dir
{% endhighlight %}

Then we get all filename like file_name.pdf.
It is good for us to do next process.
we will do pdf-to-text by using pdftotext:

{% highlight sh linenos %}
#!/bin/bash
echo "batch pdf2txt. 20140211. ver0.1"
# batch convert pdf to text.
# input : file generated by 'find . -name "*.pdf" > pdf.dir'
find . -name "*.pdf" > pdf.dir

i=0
while read line  
do
        filename="${line}";
        i=`echo "$i+1"|bc`
        echo "$i, ${filename}"  
        #rename "s/ /_/g" "${filename}"
        pdftotext "${filename}"
        mv "${filename%%.pdf}.txt"  "${filename%%.pdf}.pdftxt"  #a new filename extension.
done < pdf.dir
rm pdf.dir


#infact , we can use below command:
#       find . -name "*.pdf" -print0 | xargs -n 1 -0 pdftotext
#to process. but is NOT user friendly, and is hard to batch modify the result's filename(the *.txt which generated.)
{% endhighlight %}

so we can cat all pdf's text together:
{% highlight sh linenos %}
#!/bin/bash
# batch cat all pdftxt. 20140211. ver0.1
# input : file generated by 'find . -name "*.pdf" > pdf.dir'
# output : one text file with all pdf's text content.
find . -name "*.pdftxt" > pdftxt.dir

i=0
while read line  
do
        filename="${line}";
        i=`echo "$i+1"|bc`
        echo "$i, ${filename}"  
        #rename "s/ /_/g" "${filename}"
        #pdftotext "${filename}"  
        #mv "${filename%%.pdf}.txt"  "${filename%%.pdf}.pdftxt" #a new filename extension.
        cat ${filename} >> all.pdftxt
done < pdftxt.dir
rm pdftxt.dir
{% endhighlight %}

okay, finally we can do our Paper Parser:

{% highlight perl linenos %}
#! /usr/bin/perl -w
#paper parser , parse the paper. 20140211. ver 0.1
use strict;

use Encode;
open(FILTER, "paper_parser_ignore_word");
#open(IN,"NatureGenetic_chenchao.txt")||die;
open(IN,"all.pdftxt")||die;
open(OUT,">result");

my $symbol;
my %symset;

while(<FILTER>){
        chomp;
        $symbol = decode("UTF-8",$_);
        $symset{$symbol} = 1;

}

my %count;
my @library;
my $all_words;

my $all = 0;
        print "result:\n";
	while(<IN>){
        chomp;
        my $line = decode("UTF-8",$_);
        my @words= split " ", $line;
	foreach my $word(@words){
		if(exists($symset{$word})){
                        next;
                
		}
		if(!exists($count{$word})){
                        push @library , $word;
                
		}
                $count{$word}++;
                print "$word|"; # for debug
        
	}
        $all_words += @words;

	}
        print "\nall words : $all_words.\n";

	foreach my $ref(sort {$count{$b}<=>$count{$a}} @library){
                my $word = encode("UTF-8",$ref);
                print OUT "$word\t$count{$ref}\n";
        
	}

close IN;
close OUT;
{% endhighlight %}

in this program , we using a file which list all 'ignored words':
{% highlight sh linenos %}
symbol
。
，
©
•
••
=
the
of
and
in
to
a
with
were
for
by
is
that
The
from
et
al.
as
are
at
on
1
or
be
using
0
we
Table
We
which
In
an
J.
{% endhighlight %}

from the result file ,we can find the most frequence word is 'mutations       11607'
